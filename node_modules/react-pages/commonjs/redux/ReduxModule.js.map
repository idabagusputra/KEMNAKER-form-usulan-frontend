{"version":3,"file":"ReduxModule.js","names":["ReduxModule","namespace","generateReduxNamespace","counter","next","settings","reduxEventNaming","DEFAULT_REDUX_EVENT_NAMING","reduxPropertyNaming","underscoredToCamelCase","handlers","registered_state_properties","event","handler","Array","isArray","undefined","eventName","push","action","result","options","generateReduxEventName","createAction","sync","initialState","state","type","getEventData","error","console","reducer","createReducer","_ReactPages_ReduxEventNames","Object","keys","prototype","hasOwnProperty","call","RESULT_ACTION_PROPERTY","ERROR_ACTION_PROPERTY","apply","arguments","add_state_properties","redux","on","get_action_value_reducer","argument","add_asynchronous_action_reducers","parameters","promise","http","result_reducer","pending_event_name","success_event_name","error_event_name","pending_property_name","error_property_name","value","updated_properties","property","Counter","MAX_SAFE_INTEGER","Number","Math","pow"],"sources":["../../lib/redux/ReduxModule.js"],"sourcesContent":["import {\r\n\teventName,\r\n\tunderscoredToCamelCase,\r\n\tDEFAULT_REDUX_EVENT_NAMING,\r\n\tgenerateReduxNamespace,\r\n\tgenerateReduxEventName\r\n} from './naming.js'\r\n\r\nimport {\r\n\tRESULT_ACTION_PROPERTY,\r\n\tERROR_ACTION_PROPERTY\r\n} from './middleware/asynchronous.js'\r\n\r\n// Sometimes modules for one project are imported from another project directory.\r\n// For example, Redux actions from one project may be imported into another project.\r\n// In such cases `Counter` is not enough because Redux event names would collide\r\n// because actions from the first project use different `node_modules` and therefore\r\n// use different `react-pages` modules having their own `Counter`.\r\n// In such cases it's mandatory to pass Redux event name to `.action()` and `.simpleAction()`.\r\n// Otherwise there will be Redux event name collisions.\r\n// Importing packages from two different `node_modules` is not a good practice.\r\n\r\nexport default class ReduxModule {\r\n\tconstructor(namespace = generateReduxNamespace(counter.next()), settings = {}) {\r\n\t\tthis.namespace = namespace\r\n\t\tthis.settings = {\r\n\t\t\treduxEventNaming: settings.reduxEventNaming || DEFAULT_REDUX_EVENT_NAMING,\r\n\t\t\treduxPropertyNaming: settings.reduxPropertyNaming || underscoredToCamelCase\r\n\t\t}\r\n\r\n\t\tthis.handlers = {}\r\n\t\tthis.registered_state_properties = []\r\n\t}\r\n\r\n\treplace(event, handler) {\r\n\t\tif (!Array.isArray(handler)) {\r\n\t\t\thandler = [handler]\r\n\t\t}\r\n\t\tthis.handlers[event] = handler\r\n\t}\r\n\r\n\ton(namespace, event, handler) {\r\n\t\tif (typeof event === 'function') {\r\n\t\t\thandler = event\r\n\t\t\tevent = namespace\r\n\t\t\tnamespace = undefined\r\n\t\t} else {\r\n\t\t\t// Use \"success\" event name.\r\n\t\t\tevent = this.settings.reduxEventNaming(eventName(namespace, event))[1]\r\n\t\t}\r\n\t\tif (!this.handlers[event]) {\r\n\t\t\tthis.handlers[event] = []\r\n\t\t}\r\n\t\tthis.handlers[event].push(handler)\r\n\t}\r\n\r\n\taction(event, action, result, options) {\r\n\t\tif (event && typeof event !== 'string') {\r\n\t\t\toptions = result\r\n\t\t\tresult = action\r\n\t\t\taction = event\r\n\t\t\tevent = undefined\r\n\t\t}\r\n\t\t// Autogenerate `event` name.\r\n\t\tif (!event) {\r\n\t\t\tevent = generateReduxEventName(counter.next())\r\n\t\t}\r\n\t\toptions = options || {}\r\n\t\treturn createAction(event, action, result, options, this)\r\n\t}\r\n\r\n\tsimpleAction(event, result) {\r\n\t\tif (event && typeof event !== 'string') {\r\n\t\t\tresult = event\r\n\t\t\tevent = undefined\r\n\t\t}\r\n\t\treturn this.action(event, undefined, result, { sync: true })\r\n\t}\r\n\r\n\tcreateReducer(initialState = {}) {\r\n\t\t// Applies a handler based on the Redux action `type`.\r\n\t\t// (is copy & paste'd for all action response handlers)\r\n\t\treturn (state = initialState, event = {}) => {\r\n\t\t\ttry {\r\n\t\t\t\tfor (const handler of (this.handlers[event.type] || [])) {\r\n\t\t\t\t\tstate = handler(state, this.getEventData(event))\r\n\t\t\t\t}\r\n\t\t\t\treturn state\r\n\t\t\t} catch (error) {\r\n\t\t\t\t// For some strange reason Redux didn't report\r\n\t\t\t\t// these errors to the console, hence the manual `console.error`.\r\n\t\t\t\tconsole.error(error)\r\n\t\t\t\tthrow error\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treducer(initialState = {}) {\r\n\t\tconst reducer = this.createReducer(initialState)\r\n\t\t// The event names list is used for autogenerated\r\n\t\t// event names conflict detection.\r\n\t\t// See `checkForAutogeneratedEventNameCollision()`.\r\n\t\treducer._ReactPages_ReduxEventNames = Object.keys(this.handlers)\r\n\t\treturn reducer\r\n\t}\r\n\r\n\tgetEventData(event) {\r\n\t\tif (Object.prototype.hasOwnProperty.call(event, RESULT_ACTION_PROPERTY)) {\r\n\t\t\treturn event[RESULT_ACTION_PROPERTY]\r\n\t\t} else if (event[ERROR_ACTION_PROPERTY] !== undefined) {\r\n\t\t\treturn event[ERROR_ACTION_PROPERTY]\r\n\t\t} else {\r\n\t\t\treturn event\r\n\t\t}\r\n\t}\r\n\r\n\tadd_state_properties() {\r\n\t\tthis.registered_state_properties.push.apply(this.registered_state_properties, arguments)\r\n\t}\r\n\r\n\t// Public alias.\r\n\tproperties() {\r\n\t\tthis.add_state_properties.apply(this, arguments)\r\n\t}\r\n\r\n\t// Public alias.\r\n\tproperty() {\r\n\t\tthis.add_state_properties.apply(this, arguments)\r\n\t}\r\n}\r\n\r\n// Returns Redux action creator.\r\nfunction createAction(event, action, result, options, redux) {\r\n\tconst namespace = redux.namespace\r\n\tconst { sync } = options\r\n\r\n\t// If `result` is a property name,\r\n\t// then add that property to `connectXxx()`.\r\n\tif (typeof result === 'string') {\r\n\t\tredux.add_state_properties(result)\r\n\t}\r\n\t// If `result` is an object of property getters,\r\n\t// then add those properties to `connectXxx()`.\r\n\telse if (typeof result === 'object') {\r\n\t\tredux.add_state_properties(...Object.keys(result))\r\n\t}\r\n\r\n\t// Default \"on result\" handler is a reducer that does nothing.\r\n\t// For example, when Redux action result is ignored.\r\n\t// (I guess those would be rare cases, like \"send log message\")\r\n\tresult = result || (state => state)\r\n\r\n\t// Synchronous action\r\n\tif (sync) {\r\n\t\t// Reducer\r\n\t\tredux.on(eventName(namespace, event), get_action_value_reducer(result))\r\n\t\t// Redux \"action creator\"\r\n\t\treturn (argument) => ({\r\n\t\t\ttype: eventName(namespace, event),\r\n\t\t\t[RESULT_ACTION_PROPERTY]: argument\r\n\t\t})\r\n\t}\r\n\r\n\t// Asynchronous action\r\n\r\n\t// Add Redux reducers handling events:\r\n\t//\r\n\t//   * pending\r\n\t//   * success\r\n\t//   * error\r\n\t//\r\n\tadd_asynchronous_action_reducers(redux, namespace, event, get_action_value_reducer(result))\r\n\r\n\t// Redux \"action creator\"\r\n\treturn (...parameters) => ({\r\n\t\tevent: eventName(namespace, event),\r\n\t\tpromise: ({ http }) => action.apply(this, parameters)(http)\r\n\t})\r\n}\r\n\r\n// Adds handlers for:\r\n//\r\n//   * pending\r\n//   * done\r\n//   * failed\r\n//   * reset error\r\n//\r\nfunction add_asynchronous_action_reducers(redux, namespace, event, result_reducer) {\r\n\tconst\r\n\t[\r\n\t\tpending_event_name,\r\n\t\tsuccess_event_name,\r\n\t\terror_event_name\r\n\t]\r\n\t= redux.settings.reduxEventNaming(event)\r\n\r\n\tconst pending_property_name = redux.settings.reduxPropertyNaming(pending_event_name)\r\n\tconst error_property_name   = redux.settings.reduxPropertyNaming(error_event_name)\r\n\r\n\t// This info will be used in `storeConnector`\r\n\tredux.add_state_properties(pending_property_name, error_property_name)\r\n\r\n\t// When Promise is created: reset result variable, clear `error`, set `pending` flag.\r\n\tredux.on(eventName(namespace, pending_event_name), (state) => {\r\n\t\tstate = {\r\n\t\t\t...state,\r\n\t\t\t// Set `pending` flag\r\n\t\t\t[pending_property_name]: true\r\n\t\t}\r\n\t\t// Clear `error`\r\n\t\tdelete state[error_property_name]\r\n\t\treturn state\r\n\t})\r\n\r\n\t// When Promise succeeds: clear `pending` flag, set result variable.\r\n\tredux.on(eventName(namespace, success_event_name), (state, result) => {\r\n\t\tstate = result_reducer(state, result)\r\n\t\tdelete state[pending_property_name]\r\n\t\treturn state\r\n\t})\r\n\r\n\t// When Promise fails, clear `pending` flag and set `error`.\r\n\t// Can also clear `error` when no `error` is passed as part of an action.\r\n\tredux.on(eventName(namespace, error_event_name), (state, error) => {\r\n\t\tstate = {\r\n\t\t\t...state,\r\n\t\t\t[error_property_name]: error\r\n\t\t}\r\n\t\t// Clear `pending` flag\r\n\t\tdelete state[pending_property_name]\r\n\t\treturn state\r\n\t})\r\n}\r\n\r\n// Returns a function\r\nfunction get_action_value_reducer(reducer) {\r\n\t// If `reducer` is a property name,\r\n\t// then the reducer will write action value\r\n\t// to that property of Redux state.\r\n\tif (typeof reducer === 'string') {\r\n\t\treturn (state, value) => ({\r\n\t\t\t...state,\r\n\t\t\t[reducer]: value\r\n\t\t})\r\n\t}\r\n\r\n\t// If `reducer` is an object of property getters\r\n\t// then those properties will be added to Redux state.\r\n\tif (typeof reducer === 'object') {\r\n\t\treturn (state, value) => {\r\n\t\t\tconst updated_properties = {}\r\n\t\t\tfor (const property of Object.keys(reducer)) {\r\n\t\t\t\tupdated_properties[property] = reducer[property](value)\r\n\t\t\t\t// Don't know why did I previously write it like:\r\n\t\t\t\t// updated_properties =\r\n\t\t\t\t// {\r\n\t\t\t\t// \t...updated_properties,\r\n\t\t\t\t// \t...reducer[property](value)\r\n\t\t\t\t// }\r\n\t\t\t}\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\t...updated_properties\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// Otherwise `reducer` is `(state, value) => ...`\r\n\treturn reducer\r\n}\r\n\r\nclass Counter {\r\n\tconstructor() {\r\n\t\tthis.counter = 0\r\n\t}\r\n\r\n\tnext() {\r\n\t\tif (this.counter < MAX_SAFE_INTEGER) {\r\n\t\t\tthis.counter++\r\n\t\t} else {\r\n\t\t\tthis.counter = 1\r\n\t\t}\r\n\t\treturn this.counter\r\n\t}\r\n}\r\n\r\nconst counter = new Counter()\r\n\r\n// `MAX_SAFE_INTEGER` is not supported by older browsers\r\nconst MAX_SAFE_INTEGER = Number.MAX_SAFE_INTEGER || Math.pow(2, 53) - 1\r\n"],"mappings":"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"}